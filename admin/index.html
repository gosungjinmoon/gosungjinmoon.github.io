<!doctype html><html lang="ko"><head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GOFUNWITH Blog Admin</title>
<link rel="stylesheet" href="./css/admin.css" />
</head><body>
  <div class="admin-wrap">
    <header>
      <h1>GOFUNWITH Blog Admin</h1>
      <button id="btnLogin" class="btn">Login with GitHub</button>
      <span id="loginState" class="muted"></span>
    </header>
    <section class="card">
      <h2>새 글 작성</h2>
      <form id="postForm">
        <label>제목 <input id="title" required placeholder="제목" /></label>
        <label>내용 <textarea id="content" required placeholder="마크다운 본문"></textarea></label>
        <div class="row">
          <label><input type="radio" name="lang" value="ko" checked /> 한국어</label>
          <label><input type="radio" name="lang" value="en" /> English</label>
          <label><input type="checkbox" id="autoTr" /> 자동 번역(한→영)</label>
        </div>
        <button class="btn primary" type="submit">게시</button>
        <pre id="result" class="result"></pre>
      </form>
    </section>
  </div>
<script type="module">
import { initAuth, getAuthState } from './js/github-auth.js';
import { createNewPost } from './js/posts.js';
import { loadThemeConfig } from './js/theme-config.js';
initAuth();
const stateEl=document.getElementById('loginState');
document.getElementById('btnLogin').addEventListener('click',async()=>{
  await initAuth(true);
  stateEl.textContent=getAuthState();
});
stateEl.textContent=getAuthState();
document.getElementById('postForm').addEventListener('submit',async(e)=>{
  e.preventDefault();
  const title=document.getElementById('title').value.trim();
  const content=document.getElementById('content').value.trim();
  const lang=(new FormData(e.target)).get('lang')||'ko';
  const autoTr=document.getElementById('autoTr').checked;
  const cfg=await loadThemeConfig();
  const res=await createNewPost({title,content,lang,auto_translate:autoTr,publish_now:true,endpoint:cfg.n8n_webhook_endpoint});
  document.getElementById('result').textContent=JSON.stringify(res,null,2);
});
</script></body></html>
