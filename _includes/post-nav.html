{%- comment -%}
  Custom version for GOFUNWITH Blog
  Adds language-aware navigation (Prev/Next post within same lang)
  v20251107
{%- endcomment -%}

{%- assign current_lang = page.lang | default: site.lang | default: 'ko' -%}

{%- comment -%}
  1️⃣ 동일 언어(lang) 기준으로 posts 필터링
{%- endcomment -%}
{%- assign posts_lang = site.posts | where: "lang", current_lang | sort: "date" | reverse -%}

{%- comment -%}
  2️⃣ 현재 포스트의 index 찾기
{%- endcomment -%}
{%- assign current_index = nil -%}
{%- for post in posts_lang -%}
  {%- if post.url == page.url -%}
    {%- assign current_index = forloop.index0 -%}
  {%- endif -%}
{%- endfor -%}

{%- if current_index != nil -%}
  {%- assign prev_index = current_index | plus: 1 -%}
  {%- assign next_index = current_index | minus: 1 -%}
  {%- assign prev_post = posts_lang[prev_index] -%}
  {%- assign next_post = posts_lang[next_index] -%}
{%- endif -%}

<div class="post-navigation d-flex justify-content-between">
  {%- if prev_post -%}
    <a href="{{ prev_post.url | relative_url }}" class="btn btn-outline-primary">
      <i class="fas fa-arrow-left me-2"></i>
      {{ site.data.locales[current_lang].post.nav_prev | default: '이전 글' }}:<br>
      <strong>{{ prev_post.title }}</strong>
    </a>
  {%- else -%}
    <div></div>
  {%- endif -%}

  {%- if next_post -%}
    <a href="{{ next_post.url | relative_url }}" class="btn btn-outline-primary text-end">
      {{ site.data.locales[current_lang].post.nav_next | default: '다음 글' }}:<br>
      <strong>{{ next_post.title }}</strong>
      <i class="fas fa-arrow-right ms-2"></i>
    </a>
  {%- else -%}
    <div></div>
  {%- endif -%}
</div>
