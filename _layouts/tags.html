{% assign lang_code = page.lang | default: "ko" %}
{% assign t = site.data.config[lang_code].tags %}

<div class="tags-page">
  <h1>{{ t.title }}</h1>
  
  <h2>{{ t.all_tags }}</h2>
  {% include tag-cloud.html lang_code=lang_code %}

  <hr />

  <div class="tag-post-list">
    {% assign tags = site.tags | sort %}
    {% for tag in tags %}
      {% assign tag_name = tag[0] %}
      {% assign tag_posts = tag[1] %}

      {% assign lang_posts = "" | split: "" %}
      {% for post in tag_posts %}
        {% if post.lang == lang_code %}
          {% assign lang_posts = lang_posts | push: post %}
        {% endif %}
      {% endfor %}
      
      {% if lang_posts.size > 0 %}
        {% assign tag_data = site.data.tags[tag_name] %}
        <h2 id="{{ tag_name | slugify }}">{{ tag_data.name | default: tag_name }}</h2>
        <ul class="post-list-by-tag">
          {% for post in lang_posts reversed %}
            <li>
              <span class="post-meta">{{ post.date | date: "%Y-%m-%d" }}</span>
              <a href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endfor %}
  </div>
</div>
